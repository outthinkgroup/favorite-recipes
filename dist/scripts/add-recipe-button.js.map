{"version":3,"sources":["scripts/helpers.js","scripts/add-recipe-button.js"],"names":["BASE_URL","OPTIONS","method","credentials","headers","replaceWithForm","element","callback","formLabel","btnText","replaceParent","changeInnerTextOfEl","waitTillResolve","form","document","createElement","classList","add","parent","parentElement","addEventListener","e","replaceWith","newVal","querySelector","value","console","log","innerText","innerHTML","useApi","endpoint","data","body","JSON","stringify","fetch","then","res","json","getInputValue","selector","el","getInputValueByForm","inputs","querySelectorAll","values","reduce","valueObj","input","index","name","window","addRecipeToListButtonInit","mainComponents","forEach","component","perMainComponentDo","toggleOnOff","actionElement","parentElementSelector","action","toggleState","toggleOff","parentEl","target","closest","on","dataset","state","addRecipeToList","recipeId","listId","item_id","parseInt","list_id","toggleButton","list","handleRecipeListItemActionFromButton","clickedItem","button","plusOneCountFor","allListWithID","countEl","updatedCount"],"mappings":"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","file":"add-recipe-button.js","sourceRoot":"..","sourcesContent":["const BASE_URL = \"/wp-json/recipe-list/v1\";\nconst OPTIONS = {\n  method: \"POST\",\n  credentials: \"same-origin\",\n  headers: {\n    \"Content-Type\": \"application/json\",\n  },\n};\n\nexport function replaceWithForm({\n  element,\n  callback,\n  formLabel = null,\n  btnText = \"submit\",\n  replaceParent = false,\n  changeInnerTextOfEl = null,\n  waitTillResolve = false,\n}) {\n  const form = document.createElement(\"form\");\n  form.classList.add(\"generated-inline\");\n  const parent = element.parentElement;\n  form.addEventListener(\"submit\", (e) => {\n    callback(e, parent);\n\n    if (!replaceParent) {\n      form.replaceWith(element);\n    } else {\n      form.replaceWith(parent);\n    }\n    if (changeInnerTextOfEl) {\n      const newVal = form.querySelector(\".small-inline-input\").value;\n      console.log(newVal);\n      parent.querySelector(changeInnerTextOfEl).innerText = newVal;\n    }\n  });\n  form.innerHTML = `\n    <input type=\"text\" placeholder=\"${formLabel}\" class=\"small-inline-input\" /> \n    <button type=\"submit\">${btnText}</button>\n    `;\n  if (replaceParent === false || !replaceParent) {\n    console.log(element);\n    element.replaceWith(form);\n  } else {\n    parent.replaceWith(form);\n  }\n}\n\nexport function useApi(endpoint, data) {\n  const body = JSON.stringify(data);\n  return fetch(`${BASE_URL}/${endpoint}`, {\n    ...OPTIONS,\n    body,\n  }).then((res) => res.json());\n}\nexport function getInputValue(selector) {\n  const el = document.querySelector(selector);\n  const value = el.value;\n  return value;\n}\nexport function getInputValueByForm(form) {\n  const inputs = [...form.querySelectorAll(\"input\")];\n  const values = inputs.reduce((valueObj, input, index) => {\n    const { value, name } = input;\n    if (name) {\n      valueObj[name] = value;\n    } else {\n      valueObj[`index${index}`] = value;\n    }\n    return valueObj;\n  }, {});\n\n  return values;\n}\n","import { useApi } from \"./helpers\";\nwindow.addEventListener(\"DOMContentLoaded\", addRecipeToListButtonInit);\nfunction addRecipeToListButtonInit() {\n  const mainComponents = [...document.querySelectorAll(\".add-recipe-to-list\")];\n  mainComponents.forEach((component) => perMainComponentDo(component));\n}\n\nfunction toggleOnOff(actionElement, parentElementSelector, action = \"click\") {\n  actionElement.addEventListener(action, toggleState);\n  if (action === \"click\") {\n    document.body.addEventListener(action, toggleOff);\n  }\n  function toggleState(e) {\n    const parentEl = e.target.closest(parentElementSelector);\n    const on = parentEl.dataset.state;\n    if (on) {\n      delete parentEl.dataset.state;\n    } else {\n      parentEl.dataset.state = \"on\";\n    }\n  }\n  function toggleOff(e) {\n    if (!e.target.closest(parentElementSelector)) {\n      delete actionElement.closest(parentElementSelector).dataset.state;\n    }\n  }\n}\n\nfunction addRecipeToList({ recipeId, listId }) {\n  return useApi(\"add-item\", { item_id: parseInt(recipeId), list_id: listId });\n}\n\nfunction perMainComponentDo(component) {\n  const toggleButton = component.querySelector('[data-action=\"toggle-list\"]');\n  toggleOnOff(toggleButton, \".add-recipe-to-list\");\n\n  const list = component.querySelector(\".button-lists\");\n  list.addEventListener(\"click\", handleRecipeListItemActionFromButton);\n\n  function handleRecipeListItemActionFromButton(e) {\n    const clickedItem = e.target;\n    const button = clickedItem.closest(\"[data-action]\");\n    const action = button.dataset.action;\n\n    switch (action) {\n      case \"add-recipe\":\n        addRecipeToList({\n          recipeId: component.dataset.recipeId,\n          listId: button.dataset.listId,\n        });\n        plusOneCountFor(button.dataset.listId);\n        break;\n      default:\n        console.log(\"no action was given\");\n        break;\n    }\n  }\n\n  function plusOneCountFor(listId) {\n    const allListWithID = document.querySelectorAll(\n      `[data-list-id=\"${listId}\"]`\n    );\n    allListWithID.forEach((list) => {\n      const countEl = list.querySelector(\".recipe-title .count\");\n      const updatedCount = parseInt(countEl.innerText) + 1;\n      countEl.innerText = updatedCount;\n    });\n  }\n}\n"]}